#!/usr/bin/env python3
"""
화학물질 배출량조사 대상물질 (PRTR) 데이터베이스
- 1그룹: 20종 (연간 1톤 이상 취급시 조사대상)
- 2그룹: 395종 (연간 10톤 이상 취급시 조사대상)

사용법:
    from prtr_substances import check_prtr_status, get_prtr_group
    
    result = check_prtr_status("67-64-1")
    # {'대상여부': 'O', '그룹': 'Ⅱ', '물질명': '아세톤', '기준취급량': '10톤/년'}
"""

from typing import Dict, Optional, Tuple

# ============================================
# 1그룹 물질 (20종) - 발암성 등 고위험 물질
# 연간 1톤 이상 취급시 조사대상
# ============================================
GROUP1_SUBSTANCES = {
    "71-43-2": "벤젠",
    "75-01-4": "염화비닐",
    "106-99-0": "1,3-부타디엔",
    "107-13-1": "아크릴로니트릴",
    "79-01-6": "트리클로로에틸렌",
    "127-18-4": "테트라클로로에틸렌",
    "67-66-3": "클로로포름",
    "75-09-2": "디클로로메탄",
    "68-12-2": "N,N-디메틸포름아미드",
    "56-23-5": "사염화탄소",
    "75-21-8": "산화에틸렌",
    "106-89-8": "에피클로로히드린",
    "75-15-0": "이황화탄소",
    "62-75-9": "N-니트로소디메틸아민",
    "79-06-1": "아크릴아미드",
    "91-94-1": "3,3'-디클로로벤지딘",
    "92-87-5": "벤지딘",
    "151-56-4": "에틸렌이민",
    "302-01-2": "히드라진",
    "542-88-1": "비스(클로로메틸)에테르",
}

# ============================================
# 2그룹 물질 (395종 중 주요 물질)
# 연간 10톤 이상 취급시 조사대상
# ============================================
GROUP2_SUBSTANCES = {
    # 방향족 탄화수소
    "108-88-3": "톨루엔",
    "1330-20-7": "크실렌",
    "100-41-4": "에틸벤젠",
    "95-63-6": "1,2,4-트리메틸벤젠",
    "98-82-8": "큐멘",
    "100-42-5": "스티렌",
    "91-20-3": "나프탈렌",
    "120-12-7": "안트라센",
    
    # 알코올류
    "67-56-1": "메탄올",
    "64-17-5": "에탄올",
    "67-63-0": "이소프로필알코올",
    "71-36-3": "n-부탄올",
    "78-83-1": "이소부탄올",
    "111-76-2": "2-부톡시에탄올",
    
    # 케톤류
    "67-64-1": "아세톤",
    "78-93-3": "메틸에틸케톤",
    "108-10-1": "메틸이소부틸케톤",
    "108-94-1": "사이클로헥산온",
    
    # 에스테르류
    "141-78-6": "초산에틸",
    "123-86-4": "초산부틸",
    "108-65-6": "프로필렌글리콜모노메틸에테르아세테이트",
    
    # 에테르류
    "109-99-9": "테트라히드로푸란",
    "107-98-2": "프로필렌글리콜모노메틸에테르",
    "111-77-3": "디에틸렌글리콜모노메틸에테르",
    
    # 할로겐화 탄화수소
    "71-55-6": "1,1,1-트리클로로에탄",
    "156-60-5": "트랜스-1,2-디클로로에틸렌",
    "540-59-0": "1,2-디클로로에틸렌",
    "75-35-4": "염화비닐리덴",
    "67-72-1": "헥사클로로에탄",
    
    # 질소화합물
    "100-01-6": "p-니트로아닐린",
    "62-53-3": "아닐린",
    "121-44-8": "트리에틸아민",
    "75-50-3": "트리메틸아민",
    "100-61-8": "N-메틸아닐린",
    "108-91-8": "사이클로헥실아민",
    
    # 알데히드류
    "50-00-0": "포름알데히드",
    "75-07-0": "아세트알데히드",
    "123-38-6": "프로피온알데히드",
    
    # 산류
    "64-19-7": "초산",
    "79-09-4": "프로피온산",
    "79-10-7": "아크릴산",
    "79-41-4": "메타크릴산",
    
    # 중금속 및 화합물
    "7439-92-1": "납",
    "7440-43-9": "카드뮴",
    "7440-47-3": "크롬",
    "18540-29-9": "크롬(6가)",
    "7440-02-0": "니켈",
    "7439-96-5": "망간",
    "7440-50-8": "구리",
    "7440-66-6": "아연",
    "7439-97-6": "수은",
    "7440-38-2": "비소",
    "7782-49-2": "셀레늄",
    "7440-28-0": "탈륨",
    "7440-36-0": "안티몬",
    "7440-48-4": "코발트",
    
    # 페놀류
    "108-95-2": "페놀",
    "95-48-7": "o-크레졸",
    "108-39-4": "m-크레졸",
    "106-44-5": "p-크레졸",
    "1319-77-3": "크레졸(혼합)",
    "95-57-8": "2-클로로페놀",
    "87-86-5": "펜타클로로페놀",
    
    # 프탈레이트류
    "117-81-7": "디에틸헥실프탈레이트",
    "84-74-2": "디부틸프탈레이트",
    "85-68-7": "부틸벤질프탈레이트",
    
    # 석유계 용제
    "64742-95-6": "솔벤트나프타(경질방향족)",
    "64742-89-8": "솔벤트나프타(경질지방족)",
    "64742-48-9": "수소처리된 중질 나프타",
    
    # 기타 유기화합물
    "80-62-6": "메틸메타크릴레이트",
    "96-33-3": "메틸아크릴레이트",
    "140-88-5": "에틸아크릴레이트",
    "141-32-2": "부틸아크릴레이트",
    "110-54-3": "n-헥산",
    "142-82-5": "n-헵탄",
    "110-82-7": "사이클로헥산",
    "75-05-8": "아세토니트릴",
    "98-95-3": "니트로벤젠",
    "106-46-7": "p-디클로로벤젠",
    "95-50-1": "o-디클로로벤젠",
    "120-82-1": "1,2,4-트리클로로벤젠",
    "108-90-7": "클로로벤젠",
    "88-72-2": "o-니트로톨루엔",
    "99-08-1": "m-니트로톨루엔",
    "99-99-0": "p-니트로톨루엔",
    "100-00-5": "p-니트로클로로벤젠",
    "1675-54-3": "비스페놀A 디글리시딜에테르",
    "80-05-7": "비스페놀A",
    
    # 이소시아네이트류
    "584-84-9": "톨루엔디이소시아네이트(TDI)",
    "101-68-8": "메틸렌디페닐디이소시아네이트(MDI)",
    "822-06-0": "헥사메틸렌디이소시아네이트(HDI)",
    
    # 무기화합물
    "7664-93-9": "황산",
    "7647-01-0": "염산",
    "7697-37-2": "질산",
    "7664-38-2": "인산",
    "7664-39-3": "불화수소",
    "7783-06-4": "황화수소",
    "7782-50-5": "염소",
    "7681-49-4": "불화나트륨",
}


def get_prtr_group(cas_no: str) -> Tuple[Optional[str], Optional[str], Optional[str]]:
    """
    CAS 번호로 배출량조사 그룹 확인
    
    Args:
        cas_no: CAS 번호
    
    Returns:
        (그룹, 물질명, 기준취급량) 또는 (None, None, None)
    """
    cas_no = str(cas_no).strip()
    
    if cas_no in GROUP1_SUBSTANCES:
        return "Ⅰ", GROUP1_SUBSTANCES[cas_no], "1톤/년"
    elif cas_no in GROUP2_SUBSTANCES:
        return "Ⅱ", GROUP2_SUBSTANCES[cas_no], "10톤/년"
    else:
        return None, None, None


def check_prtr_status(cas_no: str) -> Dict:
    """
    CAS 번호로 배출량조사 대상 여부 확인
    
    Args:
        cas_no: CAS 번호
    
    Returns:
        {
            '대상여부': 'O' 또는 'X',
            '그룹': 'Ⅰ', 'Ⅱ', 또는 '-',
            '물질명': 물질명 또는 '-',
            '기준취급량': '1톤/년', '10톤/년', 또는 '-'
        }
    """
    group, name, threshold = get_prtr_group(cas_no)
    
    if group:
        return {
            "대상여부": "O",
            "그룹": group,
            "물질명": name,
            "기준취급량": threshold
        }
    else:
        return {
            "대상여부": "X",
            "그룹": "-",
            "물질명": "-",
            "기준취급량": "-"
        }


def get_all_prtr_substances() -> Dict:
    """모든 PRTR 대상물질 반환"""
    all_substances = {}
    
    for cas, name in GROUP1_SUBSTANCES.items():
        all_substances[cas] = {"물질명": name, "그룹": "Ⅰ", "기준량": "1톤/년"}
    
    for cas, name in GROUP2_SUBSTANCES.items():
        if cas not in all_substances:  # 1그룹 우선
            all_substances[cas] = {"물질명": name, "그룹": "Ⅱ", "기준량": "10톤/년"}
    
    return all_substances


# ============================================
# 테스트
# ============================================
if __name__ == "__main__":
    test_cas = ["71-43-2", "108-88-3", "1330-20-7", "67-64-1", "12345-67-8"]
    
    print("=" * 50)
    print("배출량조사 대상물질 체크 테스트")
    print("=" * 50)
    
    for cas in test_cas:
        result = check_prtr_status(cas)
        print(f"\nCAS: {cas}")
        print(f"  대상: {result['대상여부']}, 그룹: {result['그룹']}")
        print(f"  물질명: {result['물질명']}, 기준: {result['기준취급량']}")
    
    print("\n" + "=" * 50)
    print(f"총 등록된 물질 수:")
    print(f"  1그룹: {len(GROUP1_SUBSTANCES)}종")
    print(f"  2그룹: {len(GROUP2_SUBSTANCES)}종")
    print(f"  합계: {len(GROUP1_SUBSTANCES) + len(GROUP2_SUBSTANCES)}종")
